---
layout: default
lang: en
pagination:
  enabled: true
  per_page: 20
  permalink: '/page/:num/'
---

<div class="container">
  <h1 class="my-4">Game List</h1>

  <div class="row posts">
    {% for post in paginator.posts %}
      {% if post.lang == "en" %}
        <div class="col-md-6 mb-4 post">
          <!-- Post Content Here -->
        </div>
      {% endif %}
    {% endfor %}
  </div>

  {% if paginator.next_page %}
    <div class="text-center mb-4">
      <button id="load-more-btn" class="btn btn-primary" data-next-page="{{ paginator.next_page_path }}">Load More</button>
    </div>
  {% endif %}
</div>

<script>
  document.addEventListener('DOMContentLoaded', function() {
    const loadMoreBtn = document.getElementById('load-more-btn');

    if (loadMoreBtn) {
      loadMoreBtn.addEventListener('click', function() {
        const button = this;
        const nextPage = button.getAttribute('data-next-page');

        if (!nextPage) {
          console.error('No next page URL found.');
          return;
        }

        fetch(nextPage)
          .then(response => {
            if (!response.ok) {
              throw new Error('Network response was not ok');
            }
            return response.text();
          })
          .then(html => {
            const parser = new DOMParser();
            const doc = parser.parseFromString(html, 'text/html');
            const newPosts = doc.querySelectorAll('.post');

            if (newPosts.length === 0) {
              console.warn('No new posts found.');
              button.remove();
              return;
            }

            const postsContainer = document.querySelector('.posts');
            newPosts.forEach(post => postsContainer.appendChild(post));

            const newNextPage = doc.querySelector('#load-more-btn')?.getAttribute('data-next-page');
            if (newNextPage) {
              button.setAttribute('data-next-page', newNextPage);
            } else {
              button.remove();
            }
          })
          .catch(error => {
            console.error('Error fetching next page:', error);
          });
      });
    }
  });
</script>